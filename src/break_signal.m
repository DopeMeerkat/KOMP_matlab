function [r5]=break_signal(r1)
t1=[0 1 0;1 1 0;0 1 0];         %154
t2=[0 1 0;0 1 1;0 1 0];         %178
t3=[0 1 0;1 1 1;0 0 0];         %58
t4=[0 0 0;1 1 1;0 1 0];         %184
t5=[0 1 0;1 1 1;0 1 0];         %186
t6=[0 0 1;1 1 0;0 1 0];         %156
t7=[0 1 0;1 1 0;0 0 1];         %282
t8=[1 0 0;0 1 1;0 1 0];         %177
t9=[0 1 0;0 1 1;1 0 0];         %114
t10=[1 0 1;0 1 0;0 1 0];        %149
t11=[0 1 0;0 1 0;1 0 1];        %338
t12=[0 0 1;1 1 0;0 0 1];        %284
t13=[1 0 0;0 1 1;1 0 0];        %113
t14=[1 0 1;0 1 0;1 0 0];        %85
t15=[1 0 1;0 1 0;0 0 1];        %337
t16=[1 0 0;0 1 0;1 0 1];        %340
t17=[0 0 1;0 1 0;1 0 1];        %113
t18=[0 0 0;1 0 1;0 1 0];        %168
t19=[0 1 0;1 0 1;0 0 0];        %42
t20=[0 0 1;0 1 0;0 0 1];        %276
t21=[1 0 0;0 1 0;1 0 0];        %81
tt=[1 2 4;8 16 32;64 128 256];

r2=bwmorph(r1,'thin',Inf);
r3=imclose(r2, strel('disk',5));
r4=bwmorph(r3,'thin',Inf);

rr=xcorr2(double(r4>0),tt);
r5=r4;
rr=rr(2:end-1,2:end-1);
for i=1:21
    eval(['v',num2str(i),'=sum(sum(t',num2str(i),'.*tt));']);
    eval(['[x y]=find(rr==v',num2str(i),');']);
    if ~isempty(x)
        for j=1:length(x)
            if x(j)==1 | x(j)==size(r5,1) | y(j)==1 | y(j)==size(r5,2)
                continue
            else
                r5(x(j)-1:x(j)+1,y(j)-1:y(j)+1)=logical([1 0 1;1 0 1;1 0 1].*r5(x(j)-1:x(j)+1,y(j)-1:y(j)+1));
            end
        end
    end
end
r5=logical(r5);

    